#!/usr/bin/env python3
"""
N8N ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä½œæˆã‚¬ã‚¤ãƒ‰ï¼ˆåˆå¿ƒè€…å‘ã‘ï¼‰
æ—¢å­˜ã®N8Nç’°å¢ƒã§ãƒ¡ãƒ¼ãƒ«é€ä¿¡ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆ
"""

def show_browser_setup_guide():
    """ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®è©³ç´°è¨­å®šæ‰‹é †"""
    
    print("ğŸŒ **N8N ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä½œæˆã‚¬ã‚¤ãƒ‰ï¼ˆåˆå¿ƒè€…å‘ã‘ï¼‰**")
    print("=" * 60)
    print()
    
    print("## ğŸš€ **Step 1: N8Nãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹**")
    print()
    print("1. ãƒ–ãƒ©ã‚¦ã‚¶ã§ https://n8n.xvps.jp/ ã‚’é–‹ã")
    print("2. ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€ç®¡ç†è€…ã‹ã‚‰æ•™ãˆã¦ã‚‚ã‚‰ã£ãŸIDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ãƒ­ã‚°ã‚¤ãƒ³")
    print("3. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆãƒ¡ã‚¤ãƒ³ç”»é¢ï¼‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª")
    print()
    print("   ğŸ–¥ï¸ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã¯ä»¥ä¸‹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š")
    print("   â€¢ å·¦å´ï¼šãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆWorkflows, Credentials, ãªã©ï¼‰")
    print("   â€¢ ä¸­å¤®ï¼šãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¸€è¦§")
    print("   â€¢ å³ä¸Šï¼š+ New Workflow ãƒœã‚¿ãƒ³")
    print()
    
    print("## ğŸ“ **Step 2: æ–°ã—ã„ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆ**")
    print()
    print("1. å³ä¸Šã®ã€Œ+ New Workflowã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("2. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç·¨é›†ç”»é¢ãŒé–‹ãã¾ã™")
    print()
    print("   ğŸ–¥ï¸ ç·¨é›†ç”»é¢ã®æ§‹æˆï¼š")
    print("   â€¢ å·¦å´ï¼šãƒãƒ¼ãƒ‰ä¸€è¦§ï¼ˆæ¤œç´¢å¯èƒ½ï¼‰")
    print("   â€¢ ä¸­å¤®ï¼šãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚­ãƒ£ãƒ³ãƒã‚¹ï¼ˆã“ã“ã«ãƒãƒ¼ãƒ‰ã‚’é…ç½®ï¼‰")
    print("   â€¢ å³å´ï¼šé¸æŠã—ãŸãƒãƒ¼ãƒ‰ã®è¨­å®šç”»é¢")
    print("   â€¢ ä¸Šéƒ¨ï¼šä¿å­˜ã€å®Ÿè¡Œã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ãƒœã‚¿ãƒ³")
    print()
    
    print("## ğŸ“§ **Step 3: ãƒ¡ãƒ¼ãƒ«é€ä¿¡ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ä½œæˆ**")
    print()
    print("### **3-1. Webhookãƒãƒ¼ãƒ‰ï¼ˆå—ä¿¡ãƒˆãƒªã‚¬ãƒ¼ï¼‰ã®è¿½åŠ **")
    print()
    print("1. å·¦å´ã®æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã«ã€Œwebhookã€ã¨å…¥åŠ›")
    print("2. ã€ŒWebhookã€ãƒãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("3. ä¸­å¤®ã®ã‚­ãƒ£ãƒ³ãƒã‚¹ã«ãƒãƒ¼ãƒ‰ãŒè¿½åŠ ã•ã‚Œã¾ã™")
    print("4. Webhookãƒãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è¨­å®šã‚’é–‹ã")
    print()
    print("   âš™ï¸ **Webhookãƒãƒ¼ãƒ‰ã®è¨­å®šï¼š**")
    print("   â€¢ HTTP Method: POST ã‚’é¸æŠ")
    print("   â€¢ Path: hannan-email-webhook ã¨å…¥åŠ›")
    print("   â€¢ Response Mode: 'Using Respond to Webhook' Node ã‚’é¸æŠ")
    print("   â€¢ è¨­å®šå®Œäº†å¾Œã€å³ä¸Šã®ã€ŒDoneã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print()
    
    print("### **3-2. Setãƒãƒ¼ãƒ‰ï¼ˆãƒ‡ãƒ¼ã‚¿å¤‰æ›ï¼‰ã®è¿½åŠ **")
    print()
    print("1. Webhookãƒãƒ¼ãƒ‰ã®å³å´ã®å°ã•ãªã€Œ+ã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("2. æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã«ã€Œsetã€ã¨å…¥åŠ›")
    print("3. ã€ŒSetã€ãƒãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("4. Setãƒãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è¨­å®šã‚’é–‹ã")
    print()
    print("   âš™ï¸ **Setãƒãƒ¼ãƒ‰ã®è¨­å®šï¼š**")
    print("   ä»¥ä¸‹ã®5ã¤ã®å€¤ã‚’è¨­å®šã—ã¾ã™ï¼ˆã€ŒAdd Valueã€ã§è¿½åŠ ï¼‰ï¼š")
    print()
    print("   **1ã¤ç›®ï¼š**")
    print("   â€¢ Name: recipient_email")
    print("   â€¢ Value: {{ $json.email_data.recipients[0].email }}")
    print()
    print("   **2ã¤ç›®ï¼š**")
    print("   â€¢ Name: recipient_name")
    print("   â€¢ Value: {{ $json.email_data.recipients[0].name }}")
    print()
    print("   **3ã¤ç›®ï¼š**")
    print("   â€¢ Name: email_subject")
    print("   â€¢ Value: {{ $json.email_data.subject }}")
    print()
    print("   **4ã¤ç›®ï¼š**")
    print("   â€¢ Name: email_content")
    print("   â€¢ Value: {{ $json.email_data.content }}")
    print()
    print("   **5ã¤ç›®ï¼š**")
    print("   â€¢ Name: urgency")
    print("   â€¢ Value: {{ $json.email_data.urgency }}")
    print()
    print("   â€¢ å…¨ã¦å…¥åŠ›ã—ãŸã‚‰ã€ŒDoneã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print()
    
    print("### **3-3. Gmailãƒãƒ¼ãƒ‰ï¼ˆãƒ¡ãƒ¼ãƒ«é€ä¿¡ï¼‰ã®è¿½åŠ **")
    print()
    print("1. Setãƒãƒ¼ãƒ‰ã®å³å´ã®ã€Œ+ã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("2. æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã«ã€Œgmailã€ã¨å…¥åŠ›")
    print("3. ã€ŒGmailã€ãƒãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("4. Gmailãƒãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è¨­å®šã‚’é–‹ã")
    print()
    print("   âš™ï¸ **Gmailãƒãƒ¼ãƒ‰ã®è¨­å®šï¼š**")
    print("   â€¢ Operation: Send Email ã‚’é¸æŠ")
    print("   â€¢ To Email: {{ $json.recipient_email }}")
    print("   â€¢ Subject: {{ $json.email_subject }}")
    print("   â€¢ Email Type: Text ã‚’é¸æŠ")
    print("   â€¢ Message: {{ $json.email_content }}")
    print()
    print("   ğŸ” **Gmailèªè¨¼ï¼ˆé‡è¦ï¼‰ï¼š**")
    print("   â€¢ Credential: ã€ŒCreate New Credentialã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("   â€¢ ã€ŒGmail OAuth2 APIã€ã‚’é¸æŠ")
    print("   â€¢ Google Cloud Consoleã§ã®è¨­å®šãŒå¿…è¦ï¼ˆå¾Œã§è©³ã—ãèª¬æ˜ï¼‰")
    print()
    
    print("### **3-4. Respond to Webhookãƒãƒ¼ãƒ‰ï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼‰ã®è¿½åŠ **")
    print()
    print("1. Gmailãƒãƒ¼ãƒ‰ã®å³å´ã®ã€Œ+ã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("2. æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã«ã€Œrespondã€ã¨å…¥åŠ›")
    print("3. ã€ŒRespond to Webhookã€ãƒãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("4. ãƒãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è¨­å®šã‚’é–‹ã")
    print()
    print("   âš™ï¸ **Respond to Webhookãƒãƒ¼ãƒ‰ã®è¨­å®šï¼š**")
    print("   â€¢ Status Code: 200")
    print("   â€¢ Response Body Type: JSON ã‚’é¸æŠ")
    print("   â€¢ JSONå†…å®¹ï¼š")
    
    response_json = """{
  "status": "success",
  "message": "ãƒ¡ãƒ¼ãƒ«ã‚’æ­£å¸¸ã«é€ä¿¡ã—ã¾ã—ãŸ",
  "timestamp": "{{ $now.toISO() }}"
}"""
    
    print("   ```json")
    print(response_json)
    print("   ```")
    print("   â€¢ è¨­å®šå®Œäº†å¾Œã€ŒDoneã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print()

def show_gmail_auth_guide():
    """Gmailèªè¨¼è¨­å®šã®è©³ç´°ã‚¬ã‚¤ãƒ‰"""
    
    print("## ğŸ” **Gmailèªè¨¼è¨­å®šï¼ˆé‡è¦ï¼‰**")
    print("=" * 40)
    print()
    
    print("### **Gmailèªè¨¼ãŒå¿…è¦ãªç†ç”±**")
    print("N8Nã‹ã‚‰Gmailã§ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã«ã€Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®èªè¨¼ãŒå¿…è¦ã§ã™ã€‚")
    print()
    
    print("### **äº‹å‰æº–å‚™**")
    print("1. Gmailã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆé€ä¿¡ã«ä½¿ç”¨ã™ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼‰")
    print("2. Google Cloud Console ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™")
    print()
    
    print("### **Google Cloud Console ã§ã®è¨­å®š**")
    print()
    print("**Step A: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆãƒ»é¸æŠ**")
    print("1. https://console.cloud.google.com/ ã«ã‚¢ã‚¯ã‚»ã‚¹")
    print("2. æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠã€ã¾ãŸã¯æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ")
    print()
    
    print("**Step B: Gmail APIæœ‰åŠ¹åŒ–**")
    print("1. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒAPIs & Servicesã€â†’ã€ŒLibraryã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("2. æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã«ã€ŒGmail APIã€ã¨å…¥åŠ›")
    print("3. ã€ŒGmail APIã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("4. ã€Œæœ‰åŠ¹ã«ã™ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print()
    
    print("**Step C: OAuth 2.0èªè¨¼æƒ…å ±ä½œæˆ**")
    print("1. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒAPIs & Servicesã€â†’ã€ŒCredentialsã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("2. ã€Œ+ èªè¨¼æƒ…å ±ã‚’ä½œæˆã€â†’ã€ŒOAuth ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ IDã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("3. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¨®é¡ï¼šã€Œã‚¦ã‚§ãƒ– ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚’é¸æŠ")
    print("4. åå‰ï¼šã€ŒN8N Gmail Integrationã€ãªã©ä»»æ„ã®åå‰ã‚’å…¥åŠ›")
    print("5. æ‰¿èªæ¸ˆã¿ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ URI ã«ä»¥ä¸‹ã‚’è¿½åŠ ï¼š")
    print("   `https://n8n.xvps.jp/rest/oauth2-credential/callback`")
    print("6. ã€Œä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("7. è¡¨ç¤ºã•ã‚ŒãŸã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’ãƒ¡ãƒ¢")
    print()
    
    print("### **N8Nã§ã®èªè¨¼è¨­å®š**")
    print()
    print("1. N8Nã®Gmailãƒãƒ¼ãƒ‰è¨­å®šã§ã€ŒCreate New Credentialã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("2. ã€ŒGmail OAuth2 APIã€ã‚’é¸æŠ")
    print("3. Google Cloud Consoleã§ãƒ¡ãƒ¢ã—ãŸClient IDã¨Client Secretã‚’å…¥åŠ›")
    print("4. ã€ŒConnect my accountã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("5. Googleã®èªè¨¼ç”»é¢ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã€ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯")
    print("6. èªè¨¼æˆåŠŸå¾Œã€ŒSaveã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print()

def show_final_steps():
    """æœ€çµ‚è¨­å®šã¨ãƒ†ã‚¹ãƒˆ"""
    
    print("## ğŸ¯ **æœ€çµ‚è¨­å®šã¨ãƒ†ã‚¹ãƒˆ**")
    print("=" * 30)
    print()
    
    print("### **ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ä¿å­˜ã¨æœ‰åŠ¹åŒ–**")
    print()
    print("1. ç”»é¢å³ä¸Šã®ã€ŒSaveã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("2. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼åã‚’å…¥åŠ›ï¼šã€Œé˜ªå—ãƒ“ã‚¸ãƒã‚¹ãƒã‚·ãƒ³ ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã€")
    print("3. ã€ŒSaveã€ã§ä¿å­˜å®Œäº†")
    print("4. ç”»é¢å³ä¸Šã®ãƒˆã‚°ãƒ«ã‚¹ã‚¤ãƒƒãƒã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€ŒActiveã€ã«å¤‰æ›´")
    print("   ï¼ˆã‚°ãƒ¬ãƒ¼ â†’ ç·‘è‰²ã«å¤‰ã‚ã‚Œã°OKï¼‰")
    print()
    
    print("### **Webhook URLã®å–å¾—**")
    print()
    print("1. Webhookãƒãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("2. ã€ŒCopyã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦URLã‚’ã‚³ãƒ”ãƒ¼")
    print("3. URLã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå½¢å¼ã«ãªã‚Šã¾ã™ï¼š")
    print("   `https://n8n.xvps.jp/webhook/hannan-email-webhook`")
    print()
    
    print("### **ç’°å¢ƒå¤‰æ•°ã®è¨­å®š**")
    print()
    print("ã‚³ãƒ”ãƒ¼ã—ãŸWebhook URLã‚’é˜ªå—ãƒ“ã‚¸ãƒã‚¹ãƒã‚·ãƒ³ã®ã‚·ã‚¹ãƒ†ãƒ ã«è¨­å®šï¼š")
    print()
    print("```bash")
    print("# .envãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ")
    print("N8N_WEBHOOK_URL=https://n8n.xvps.jp/webhook/hannan-email-webhook")
    print("```")
    print()
    
    print("### **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†èµ·å‹•**")
    print()
    print("```bash")
    print("cd /Users/akamatsu/Desktop/ai-agent/src")
    print("# Ctrl+C ã§åœæ­¢")
    print("uvicorn main:app --host 0.0.0.0 --port 8000 --reload")
    print("```")
    print()
    
    print("### **å‹•ä½œãƒ†ã‚¹ãƒˆ**")
    print()
    print("1. **N8Nã§ã®ãƒ†ã‚¹ãƒˆ**ï¼š")
    print("   â€¢ Webhookãƒãƒ¼ãƒ‰ã®ã€ŒListen for callsã€ã‚’ã‚¯ãƒªãƒƒã‚¯")
    print("   â€¢ åˆ¥ã‚¿ãƒ–ã§ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ï¼ˆcURLã‚³ãƒãƒ³ãƒ‰ï¼‰")
    print()
    print("2. **LINEã§ã®ãƒ†ã‚¹ãƒˆ**ï¼š")
    print("   â€¢ ã€Œæœ‰çµ¦ç”³è«‹ã®æ–¹æ³•ã‚’æ•™ãˆã¦ã€")
    print("   â€¢ ã€Œç”°ä¸­ã•ã‚“ã«ãƒ¡ãƒ¼ãƒ«ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€")
    print()
    print("3. **æœŸå¾…ã•ã‚Œã‚‹çµæœ**ï¼š")
    print("   â€¢ âŒ ~~ã€ŒN8Né€£æºã¯ç¾åœ¨ç„¡åŠ¹ã§ã™ã€~~")
    print("   â€¢ âœ… **ã€Œãƒ¡ãƒ¼ãƒ«é€ä¿¡å®Œäº†ã€**")

def create_test_data():
    """ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿"""
    
    print("\n## ğŸ§ª **ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿**")
    print("=" * 20)
    print()
    
    test_curl = """curl -X POST https://n8n.xvps.jp/webhook/hannan-email-webhook \\
  -H "Content-Type: application/json" \\
  -d '{
    "action": "send_email",
    "email_data": {
      "recipients": [
        {
          "email": "test@example.com",
          "name": "ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼"
        }
      ],
      "subject": "ã€ãƒ†ã‚¹ãƒˆã€‘N8Né€£æºç¢ºèª",
      "content": "N8Nãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ãƒ†ã‚¹ãƒˆãƒ¡ãƒ¼ãƒ«ã§ã™ã€‚",
      "urgency": "normal"
    }
  }'"""
    
    print("**cURLã‚³ãƒãƒ³ãƒ‰ã§ã®ãƒ†ã‚¹ãƒˆï¼š**")
    print("```bash")
    print(test_curl)
    print("```")

if __name__ == "__main__":
    show_browser_setup_guide()
    show_gmail_auth_guide()
    show_final_steps()
    create_test_data()
