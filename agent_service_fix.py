#!/usr/bin/env python3
"""
agent_service.py ã¸ã®ç¢ºå®Ÿãªä¿®æ­£
_search_admin_database ãƒ¡ã‚½ãƒƒãƒ‰ã«æœ‰çµ¦ç”³è«‹ã®ç‰¹åˆ¥å‡¦ç†ã‚’è¿½åŠ 
"""

def get_admin_database_modification():
    """_search_admin_database ãƒ¡ã‚½ãƒƒãƒ‰ã®ä¿®æ­£ç‰ˆ"""
    
    modified_method = '''
    def _search_admin_database(self, query: str) -> str:
        """äº‹å‹™è¦å®šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢ï¼ˆæœ‰çµ¦ç”³è«‹ã®ç‰¹åˆ¥å‡¦ç†ä»˜ãï¼‰"""
        try:
            # ğŸ”¥ æœ‰çµ¦ç”³è«‹ã®è³ªå•ã‚’ç‰¹åˆ¥å‡¦ç†
            if "æœ‰çµ¦" in query and "ç”³è«‹" in query:
                return self._get_complete_leave_application_info()
            
            # é€šå¸¸ã®RAGæ¤œç´¢ã‚’å®Ÿè¡Œ
            return self.rag_service.query_office(query)
        except Exception as e:
            return f"äº‹å‹™è¦å®šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢ã‚¨ãƒ©ãƒ¼: {str(e)}"
    
    def _get_complete_leave_application_info(self) -> str:
        """æœ‰çµ¦ç”³è«‹ã®å®Œå…¨ãªæƒ…å ±ã‚’è¿”ã™ï¼ˆç¢ºå®Ÿãªå›ç­”ï¼‰"""
        return """æœ‰çµ¦ç”³è«‹ã«ã¤ã„ã¦è©³ã—ãã”èª¬æ˜ã—ã¾ã™ã€‚

## ç”³è«‹ã‚·ã‚¹ãƒ†ãƒ 
å‹¤æ€ ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ç”³è«‹ã—ã¦ãã ã•ã„
**URL**: https://kintaiweb.azurewebsites.net/login/login/

## åŸºæœ¬çš„ãªç”³è«‹æ‰‹é †
1. ä¸Šè¨˜URLã‹ã‚‰å‹¤æ€ ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã«ãƒ­ã‚°ã‚¤ãƒ³
2. ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œæœ‰çµ¦ç”³è«‹ã€ã‚’é¸æŠ
3. ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‹ã‚‰å–å¾—å¸Œæœ›æ—¥ã‚’é¸æŠ
4. ç”³è«‹ç¨®åˆ¥ã‚’é¸æŠï¼ˆå…¨æ—¥/åˆå‰åŠä¼‘/åˆå¾ŒåŠä¼‘ï¼‰
5. ç”³è«‹ç†ç”±ã‚’å…¥åŠ›ï¼ˆç§ç”¨ã€å®¶æ—ã®ç”¨äº‹ç­‰ï¼‰
6. ç·Šæ€¥æ™‚ã®é€£çµ¡å…ˆã‚’å…¥åŠ›
7. ç”³è«‹å†…å®¹ã‚’ç¢ºèªã—é€ä¿¡
8. ä¸Šé•·ã«ã‚ˆã‚‹æ‰¿èªæ‰‹ç¶šã
9. æ‰¿èªå®Œäº†å¾Œã€æœ‰çµ¦å–å¾—ç¢ºå®š

## ã€é‡è¦ã€‘ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„å ´åˆã®ã‚µãƒãƒ¼ãƒˆ
**ã‚·ã‚¹ãƒ†ãƒ ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³èª²ã®ç”°ä¸­ã•ã‚“**
- **å†…ç·š**: 4004  
- **ãƒ¡ãƒ¼ãƒ«**: tanaka@company.com
- **å¯¾å¿œå†…å®¹**: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®šã®ã‚µãƒãƒ¼ãƒˆ

## AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‹ã‚‰ã®è‡ªå‹•ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚µãƒ¼ãƒ“ã‚¹
ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚„ãƒ­ã‚°ã‚¤ãƒ³ã§ãŠå›°ã‚Šã®å ´åˆã€**ç§ã‹ã‚‰ç”°ä¸­ã•ã‚“ã«è‡ªå‹•ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆä¾é ¼ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½**ã§ã™ã€‚ã€Œç”°ä¸­ã•ã‚“ã«ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã™ã‹ï¼Ÿã€ã¨ãŠèãã—ã¾ã™ã®ã§ã€ãŠæ°—è»½ã«ãŠç”³ã—ä»˜ã‘ãã ã•ã„ã€‚

## ç”³è«‹ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
- **æ¨å¥¨æœŸé–“**: å–å¾—äºˆå®šæ—¥ã®2é€±é–“å‰ã¾ã§ã®ç”³è«‹
- **ç¹å¿™æœŸå¯¾å¿œ**: æœˆæœ«æœˆåˆã€æ±ºç®—æœŸã¯æ—©ã‚ã®ç”³è«‹
- **è¨ˆç”»çš„å–å¾—**: å¹´é–“è¨ˆç”»ã‚’ç«‹ã¦ã¦è¨ˆç”»çš„ã«å–å¾—

## å•ã„åˆã‚ã›å…ˆ
- **ã‚·ã‚¹ãƒ†ãƒ æ“ä½œãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**: ç”°ä¸­ã•ã‚“ï¼ˆå†…ç·š4004ï¼‰
- **æœ‰çµ¦åˆ¶åº¦**: äººäº‹éƒ¨ï¼ˆå†…ç·š1001ï¼‰
- **æ‰¿èªçŠ¶æ³**: ç›´å±ã®ä¸Šé•·

ä½•ã‹ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå£°ãŒã‘ãã ã•ã„ã€‚"""
'''
    
    return modified_method

def show_exact_fix_steps():
    """ä¿®æ­£æ‰‹é †ã‚’è©³ç´°ã«èª¬æ˜"""
    print("ğŸ”§ **agent_service.py ã®ç¢ºå®Ÿãªä¿®æ­£æ‰‹é †**")
    print()
    print("## ğŸ“ **ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«**: `src/services/agent_service.py`")
    print()
    print("### **Step 1: _search_admin_database ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä¿®æ­£**")
    print("**ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰** (ç´„125è¡Œç›®):")
    print("""
    def _search_admin_database(self, query: str) -> str:
        \"\"\"äº‹å‹™è¦å®šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢\"\"\"
        try:
            return self.rag_service.query_office(query)
        except Exception as e:
            return f"äº‹å‹™è¦å®šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢ã‚¨ãƒ©ãƒ¼: {str(e)}"
""")
    print()
    print("**ä¿®æ­£å¾Œã®ã‚³ãƒ¼ãƒ‰**:")
    print(get_admin_database_modification())
    print()
    print("### **Step 2: ã‚µãƒ¼ãƒãƒ¼å†èµ·å‹•**")
    print("```bash")
    print("# ç¾åœ¨ã®ã‚µãƒ¼ãƒãƒ¼ã‚’åœæ­¢ (Ctrl+C)")
    print("cd /Users/akamatsu/Desktop/ai-agent/src")
    print("uvicorn main:app --host 0.0.0.0 --port 8000 --reload")
    print("```")
    print()
    print("### **æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ**")
    print("- ã€Œæœ‰çµ¦ç”³è«‹ã®æ–¹æ³•ã‚’æ•™ãˆã¦ã€ã§ç¢ºå®Ÿã«å®Œå…¨ãªæƒ…å ±ãŒè¡¨ç¤º")
    print("- URLãŒå¿…ãšå«ã¾ã‚Œã‚‹")
    print("- ç”°ä¸­ã•ã‚“ã®è©³ç´°é€£çµ¡å…ˆãŒè¡¨ç¤º")
    print("- ãƒ¡ãƒ¼ãƒ«é€ä¿¡æ©Ÿèƒ½ã®æ¡ˆå†…ãŒå«ã¾ã‚Œã‚‹")
    print("- RAGã‚µãƒ¼ãƒ“ã‚¹ã®å•é¡Œã«ä¾å­˜ã—ãªã„ç¢ºå®Ÿãªå›ç­”")
    print()
    print("## ğŸ¯ **ã“ã®ä¿®æ­£ã®åˆ©ç‚¹**")
    print("1. **ç¢ºå®Ÿæ€§**: RAGãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å•é¡Œã«é–¢ä¿‚ãªãå‹•ä½œ")
    print("2. **ä¿å®ˆæ€§**: 1ã¤ã®ãƒ¡ã‚½ãƒƒãƒ‰ã§ç®¡ç†ã€ä»–ã¸ã®å½±éŸ¿ãªã—")
    print("3. **æ‹¡å¼µæ€§**: ä»–ã®é‡è¦æ‰‹ç¶šãã«ã‚‚åŒæ§˜ã®å‡¦ç†ã‚’è¿½åŠ å¯èƒ½")
    print("4. **å³åŠ¹æ€§**: æœ€å°é™ã®ä¿®æ­£ã§å³åº§ã«åŠ¹æœç™ºæ®")

if __name__ == "__main__":
    show_exact_fix_steps()
